getgenv().ImportMacro = "https://cdn.discordapp.com/attachments/1252574910803480587/1289847629936853002/drill.txt?ex=67038a37&is=670238b7&hm=812cfab0aa6fb5b3a06ed6e68dac5ed4182ad2db6bd9b30beb2191d5e2c42df8&"
getgenv().EquipMacroTroop = true
getgenv().Config = {["JoinFailsafe"]=true,["RequiredGem"]=100,["SellRarities"]={["Legendary"]=false,["Basic"]=false,["Epic"]=false,["Uncommon"]=false,["Rare"]=false},["DelayReplay"]=5,["WH_MatchComplete"]=true,["AutoSkip"]=true,["AutoClaimQuest"]=true,["TPLobbyIfPlayer"]=true,["WH_MailSent"]=false,["IgnoreMacroTiming"]=true,["SelectMacro"]="drill",["ALFS_DelayHop"]=30,["PlaceFailsafe"]=true,["AutoJoinEndless"]=false,["PlayMacro"]=true,["AutoMail"]=true,["AutoUseBoost"]=true,["AutoSummonTroop"]=false,["BoostFPS"]=true,["AutoReplay"]=true,["Summon10"]=true,["DelayJoin"]=60,["SellWave"]=1,["AutoClaimEventPass"]=true,["AutoClaimPlaytimeReward"]=true,["BuyEventName"]="hFtBbJbDwJf",["RequireRoll"]=0,["AutoJoinMatch"]=true,["ALFS_HopServer"]=false,["SelectMap"]="DrillWorld (Rewind)",["AutoVoteDifficulty"]=false,["AutoSellOW"]=false,["AutoSave"]=true,["MailName"]="IXORNPCeLud",["AutoRejoin"]=true,["AutoClaimVIP"]=false,["AutoBuyEvent"]=true,["AutoListForSale"]=false,["UseAll"]=true,["AutoClaimEventQuest"]=true,["DeleteMap"]=true,["WebhookURL"]="https://discord.com/api/webhooks/1285140258752823380/i_xCqDW3cQNRakEMWvgdJry9WcOu0ZlZ8LtnsrU6MeRas1ZJlNoyMwv-RIwgMjuCoThy",["SummonDelay"]=0.3,["ABE_Gift"]=true,["AutoClaimDailyReward"]=true,["AutoReturnToLobby"]=true,["UseBoosts"]={["2xLuckBoost_1"]=true,["2xEggsBoost"]=false,["2xLuckBoost_10"]=true,["2xEventXPBoost"]=false,["2xXPBoost"]=false,["2xClocksBoost"]=false,["2xCoinsBoost_1"]=true,["2xDrillXPBoost"]=false,["2xEventXPBoost_1"]=true,["2xXPBoost_10"]=true,["2xCoinsBoost_10"]=true,["2xXPBoost_Easter2024"]=false,["2xCloversBoost"]=false,["Weekend_2xEndlessXPBoost"]=false,["Weekend_2xCoinsBoost"]=false,["2xLuckBoost"]=false,["2xDrillBoost"]=false,["2xEventXPBoost_10"]=true,["2xXPBoost_1"]=true,["2xCoinsBoost"]=false},["BlackScreen"]=true}
getgenv().Key = "kb0ead1d709dff85b479a22e"
repeat wait()spawn(function()loadstring(game:HttpGet("https://nousigi.com/loader.lua"))()end)wait(10)until Joebiden
wait(1)
if not getupvalue then getupvalue = debug.getupvalue end
local users = {
"EYEQeDXgcJJ",

}

local troopsToSend = {
    "Actellect75"
}


local TTD
local save
local handler
local Network
local Invoke
local Fire
task.spawn(function()
    TTD = require(game:GetService("ReplicatedStorage").MultiboxFramework)
    save = TTD.Replicate:WaitForReplica("PlayerData-" .. game:GetService("Players").LocalPlayer.UserId)

    repeat
        pcall(function()
            Network = TTD.Network
            Invoke = Network.Invoke
            Fire = Network.Fire
        end)
        task.wait(0.1)
    until Network ~= nil and Invoke ~= nil and Fire ~= nil
end)
repeat wait() until Invoke and Network and Fire

local SInd = debug.info(Invoke,"s")
local old =  getrenv().debug.info
setreadonly(getrenv().debug,false)

getrenv().debug.info = function(...) 
    local lv,st = ...
    if lv == 2 and st == "s" then 
        return SInd
    end
    error("hi")
    return nil
end
setreadonly(getrenv().debug,true)

local old = getrenv().getfenv
getrenv().getfenv = function(...) 
    error("hi")
    return nil
end
-- Invoke = Network.Invoke; local GetFunc = getupvalue(Invoke, 1)
-- Fire = Network.Fire; local GetEvent = getupvalue(Fire, 1)

-- coroutine.wrap(function()
--     setidentity(2)
--     hookfunc(getupvalue(GetFunc, 1), function()
--         return true
--     end)
--     setidentity(8)
-- end)()

-- coroutine.wrap(function()
--     setidentity(2)
--     hookfunc(getupvalue(GetEvent, 1), function()
--         return true
--     end)
--     setidentity(8)
-- end)()


local invTroops = {}
function getInventoryTroops()
    invTroops = {}
    local save = TTD.Replicate:WaitForReplica("PlayerData-" .. game:GetService("Players").LocalPlayer.UserId)
   -- for k,v in save._data.InventoryItems.Troops do print(k,v) end
    for name, v in pairs(save._data.InventoryItems.Troops) do
        for i, v in pairs(v) do
            invTroops[i] = name
        end
    end
    return invTroops
end

local coins
function getCoinAmt()
    coins = 0
    local save = TTD.Replicate:WaitForReplica("PlayerData-" .. game:GetService("Players").LocalPlayer.UserId)
    for i, v in pairs(save._data) do
        if i == "Currencies" then
            coins = v.Coins
        end
    end
    return coins
end

function hasTroop(id)
    troops = getInventoryTroops()
    for i, v in troops do
        if i == id then
            return true
        end
    end
    return false
end

startAmt = getCoinAmt()

local amt = 0

for i, user in users do
    local sent = {}
    for i, v in getInventoryTroops() do
        if table.find(troopsToSend, v) and not table.find(sent, v) then
            table.insert(sent, v)
            local oldC = getCoinAmt()
            local st = tick()
            repeat
                Invoke("PostOffice_SendGift", game.Players:GetUserIdFromNameAsync(user), "Troops", i, 0,
                    tostring(math.random(1, 10000)))
                task.wait(0.1)
            until getCoinAmt() < oldC and not hasTroop(i)
            print("sent","time taken:",tick()-st)
        end
    end
    print('finished user:',user)
end

print('Should have sent:', amt)
